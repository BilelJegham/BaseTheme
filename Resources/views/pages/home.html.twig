{% extends '@BaseTheme/pages/base.html.twig' %}

{% block header %}
    <header class="page-header">
        {% if headerImage %}
            <figure class="page-header-image">{{ headerImage|display(imageFormats.headerImage) }}</figure>
        {% endif %}
        <div class="container">
            <h1 class="page-title">{{ nodeSource.title }}</h1>
        </div>
    </header>
{% endblock %}
{% block inner_content %}
    <div class="container">
        {% if node %}
            <p>{{ "node.name.is.%name%"|trans({'%name%':node.nodeSources.first.title }) }}</p>
        {% endif %}
        {% if translation %}
            <p>{{ "translation.is.%name%"|trans({'%name%':translation.getName }) }}</p>
        {% endif %}
    </div>

     {% if nodeSource %}
        <div class="page-blocks">
            {#
             # Page blocks pattern implementation
             #}
            {% set blocks = nodeSource|children({
                'node.nodeType' : ['!=', bags.nodeTypes.get('Page')],
                'node.visible': true,
            }) %}
            {% for singleBlock in blocks %}
                {% include '@BaseTheme/blocks/' ~ singleBlock.node.nodeType.name|lower ~ '.html.twig' ignore missing with {
                'nodeSource': singleBlock,
                'parentNodeSource': nodeSource,
                'themeServices': themeServices,
                'head': head,
                'node': singleBlock.node,
                'nodeType': singleBlock.node.nodeType,
                'loop': loop,
                'blocksLength':blocks|length,
                'bags': bags
                } only %}
            {% endfor %}
        </div>
        <div class="images">
            {% for image in nodeSource.images %}
                {% set imageMetas = image.documentTranslations.first %}
                <figure class="image">
                    {{ image|display(imageFormats.thumbnail) }}
                    <figcaption>{{ imageMetas.name }} â€” {{ imageMetas.copyright }}</figcaption>
                </figure>
            {% endfor %}
        </div>
    {% else %}
        <div class="container">
            <p>There is no node attached to this view.</p>
        </div>
    {% endif %}
{% endblock %}
